<!-- æ‹³é¦†åœºåœ°ç®¡ç†é¡µ -->
<view class="container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="nav-bar" style="padding-top: {{statusBarHeight}}px; height: {{navBarHeight}}px;">
    <view class="nav-bar-content">
      <text class="nav-bar-title">åœºåœ°ç®¡ç†</text>
      <text class="nav-bar-back" bindtap="onBack">â†</text>
    </view>
  </view>

  <!-- å¤´éƒ¨ç»Ÿè®¡ -->
  <view class="header">
    <view class="stats">
      <view class="stat-item">
        <text class="stat-value">{{activeCount}}</text>
        <text class="stat-label">ä¸ªå¯ç”¨</text>
      </view>
      <view class="stat-item" wx:if="{{bookedCount > 0}}">
        <text class="stat-value">{{bookedCount}}</text>
        <text class="stat-label">ä¸ªå·²é¢„çº¦</text>
      </view>
    </view>
    <text class="title">æˆ‘çš„åœºåœ°</text>
  </view>

  <!-- çŠ¶æ€åˆ‡æ¢ -->
  <view class="status-tabs">
    <view
      class="status-tab {{currentStatus === 'active' ? 'active' : ''}}"
      bindtap="onStatusChange"
      data-status="active"
    >
      <text>å¯ç”¨ä¸­</text>
    </view>
    <view
      class="status-tab {{currentStatus === 'all' ? 'active' : ''}}"
      bindtap="onStatusChange"
      data-status="all"
    >
      <text>å…¨éƒ¨</text>
    </view>
    <view
      class="status-tab {{currentStatus === 'cancelled' ? 'active' : ''}}"
      bindtap="onStatusChange"
      data-status="cancelled"
    >
      <text>å·²æ’¤é”€</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading && list.length === 0}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{!loading && list.length === 0}}">
    <text class="empty-icon">ğŸ“…</text>
    <text class="empty-text">æš‚æ— æ—¶é—´æ®µï¼Œå¿«å»å‘å¸ƒå§</text>
  </view>

  <!-- æ—¶é—´æ®µåˆ—è¡¨ -->
  <view class="list" wx:if="{{list.length > 0}}">
    <view class="card slot-card" wx:for="{{list}}" wx:key="slot_id">
      <view class="slot-date">
        <text class="date-text">{{item.date}}</text>
        <view class="status-badge {{item.status === 'active' ? 'active' : 'cancelled'}}">
          <text>{{item.status === 'active' ? 'å¯ç”¨' : 'å·²æ’¤é”€'}}</text>
        </view>
      </view>

      <view class="slot-time">
        <text class="time-icon">â°</text>
        <text class="time-text">{{item.start_time}} - {{item.end_time}}</text>
      </view>

      <view class="slot-capacity">
        <text class="capacity-icon">ğŸ‘¥</text>
        <text class="capacity-text">
          {{item.current_bookings}}/{{item.max_boxers}}
          <text wx:if="{{item.available_spots > 0}}"> (ä½™{{item.available_spots}})</text>
          <text wx:else> (å·²æ»¡)</text>
        </text>
      </view>

      <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
      <view class="slot-actions" wx:if="{{item.status === 'active'}}">
        <!-- å¯ç¼–è¾‘æ—¶çš„æŒ‰é’® -->
        <view class="actions-row" wx:if="{{item.can_modify}}">
          <button
            class="action-btn edit-btn"
            bindtap="onEdit"
            data-id="{{item.slot_id}}"
            disabled="{{item.editing}}"
          >
            {{item.editing ? 'å¤„ç†ä¸­...' : 'ç¼–è¾‘'}}
          </button>
          <button
            class="action-btn delete-btn"
            bindtap="onDelete"
            data-id="{{item.slot_id}}"
            data-index="{{index}}"
            disabled="{{item.deleting}}"
          >
            {{item.deleting ? 'å¤„ç†ä¸­...' : 'æ’¤é”€'}}
          </button>
        </view>

        <!-- ä¸å¯ç¼–è¾‘æ—¶çš„æç¤º -->
        <view class="actions-row locked" wx:else>
          <view class="locked-badge">
            <text class="locked-icon">ğŸ”’</text>
            <text class="locked-text">æœ‰é¢„çº¦ä¸å¯ç¼–è¾‘</text>
          </view>
          <button
            class="action-btn view-btn"
            bindtap="onViewBookings"
            data-id="{{item.slot_id}}"
          >
            æŸ¥çœ‹é¢„çº¦ ({{item.current_bookings}})
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- å‘å¸ƒæŒ‰é’® -->
  <view class="fab" bindtap="onPublish">
    <text class="fab-icon">+</text>
    <text class="fab-text">å‘å¸ƒæ—¶é—´æ®µ</text>
  </view>
</view>
