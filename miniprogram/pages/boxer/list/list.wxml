<!-- æ‹³æ‰‹åˆ—è¡¨é¡µ -->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="stats">
      <view class="stat-item">
        <text class="stat-value">{{hasFilters ? displayCount : totalCount}}</text>
        <text class="stat-label">{{hasFilters ? 'ä½ç¬¦åˆ' : 'ä½æ‹³æ‰‹'}}</text>
      </view>
    </view>
    <text class="title">æµè§ˆæ‹³æ‰‹</text>
  </view>

  <!-- ç­›é€‰æ  - æ¨ªå‘æ»šåŠ¨ -->
  <view class="filters-scroll">
    <scroll-view class="filters-scroll-view" scroll-x enable-flex>
      <!-- åŸå¸‚é€‰æ‹© -->
      <view class="filter-chip" bindtap="onShowCityPicker">
        <text class="filter-chip-text">{{filters.cityDisplay || 'åŸå¸‚'}}</text>
        <text class="filter-chip-icon">â–¼</text>
      </view>

      <!-- æ€§åˆ«é€‰æ‹© -->
      <picker
        class="filter-chip-picker"
        mode="selector"
        range="{{genderOptions}}"
        range-key="label"
        value="{{genderIndex}}"
        bindchange="onGenderChange"
      >
        <view class="filter-chip">
          <text class="filter-chip-text">{{genderDisplay || 'æ€§åˆ«'}}</text>
          <text class="filter-chip-icon">â–¼</text>
        </view>
      </picker>

      <!-- å¹´é¾„æœ€å°å€¼ -->
      <input
        class="filter-input-chip"
        type="number"
        placeholder="æœ€å°å¹´é¾„"
        value="{{filters.age_min}}"
        bindinput="onAgeMinInput"
      />

      <!-- å¹´é¾„æœ€å¤§å€¼ -->
      <input
        class="filter-input-chip"
        type="number"
        placeholder="æœ€å¤§å¹´é¾„"
        value="{{filters.age_max}}"
        bindinput="onAgeMaxInput"
      />

      <!-- ä½“é‡æœ€å°å€¼ -->
      <input
        class="filter-input-chip"
        type="number"
        placeholder="æœ€å°ä½“é‡"
        value="{{filters.weight_min}}"
        bindinput="onWeightMinInput"
      />

      <!-- ä½“é‡æœ€å¤§å€¼ -->
      <input
        class="filter-input-chip"
        type="number"
        placeholder="æœ€å¤§ä½“é‡"
        value="{{filters.weight_max}}"
        bindinput="onWeightMaxInput"
      />

      <!-- æ¸…ç©ºç­›é€‰æŒ‰é’® -->
      <view class="filter-chip filter-chip-action" bindtap="onClearFilters" wx:if="{{hasFilters}}">
        <text class="filter-chip-text">æ¸…ç©º</text>
      </view>

      <!-- åº”ç”¨ç­›é€‰æŒ‰é’® -->
      <view class="filter-chip filter-chip-primary" bindtap="onApplyFilters">
        <text class="filter-chip-text">ç­›é€‰</text>
      </view>
    </scroll-view>
  </view>

  <!-- åŸå¸‚é€‰æ‹©å¼¹çª— -->
  <view class="city-picker-modal" wx:if="{{showCityPicker}}">
    <view class="city-picker-mask" bindtap="onHideCityPicker"></view>
    <view class="city-picker-content">
      <view class="city-picker-header">
        <text class="city-picker-title">é€‰æ‹©åŸå¸‚</text>
        <text class="city-picker-close" bindtap="onHideCityPicker">âœ•</text>
      </view>
      <view class="city-picker-body">
        <picker-view
          class="city-picker-view"
          indicator-style="height: 50px;"
          value="{{cityPickerValue}}"
          bindchange="onCityPickerChange"
        >
          <picker-view-column>
            <view wx:for="{{provinces}}" wx:key="*this">{{item}}</view>
          </picker-view-column>
          <picker-view-column>
            <view wx:for="{{cities}}" wx:key="*this">{{item}}</view>
          </picker-view-column>
        </picker-view>
      </view>
      <view class="city-picker-footer">
        <button class="city-picker-btn city-picker-btn-cancel" bindtap="onHideCityPicker">å–æ¶ˆ</button>
        <button class="city-picker-btn city-picker-btn-confirm" bindtap="onConfirmCity">ç¡®å®š</button>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading && list.length === 0}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{!loading && list.length === 0}}">
    <text class="empty-icon">ğŸ¥Š</text>
    <text class="empty-text">{{hasFilters ? 'æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æ‹³æ‰‹' : 'æš‚æ— æ‹³æ‰‹æ•°æ®'}}</text>
  </view>

  <!-- æ‹³æ‰‹åˆ—è¡¨ -->
  <view class="list" wx:if="{{list.length > 0}}">
    <view class="card" wx:for="{{list}}" wx:key="boxer_id" bindtap="onCardTap" data-id="{{item.boxer_id}}">
      <view class="card-avatar">ğŸ¥Š</view>
      <view class="card-info">
        <view class="card-name">
          <text>{{item.nickname}}</text>
          <text class="gender-icon {{item.gender === 'male' ? 'male' : 'female'}}">
            {{item.gender === 'male' ? 'â™‚' : 'â™€'}}
          </text>
        </view>
        <view class="card-details">
          <view class="card-detail-item" wx:if="{{item.age}}">
            <text>{{item.age}}å²</text>
          </view>
          <view class="card-detail-item">
            <text>{{item.height}}cm</text>
          </view>
          <view class="card-detail-item">
            <text>{{item.weight}}kg</text>
          </view>
          <view class="card-detail-item" wx:if="{{item.city}}">
            <text>{{item.city}}</text>
          </view>
        </view>
        <view class="card-record" wx:if="{{item.record_wins > 0 || item.record_losses > 0 || item.record_draws > 0}}">
          <view class="record-item wins">
            <text>{{item.record_wins}}</text>
            <text>èƒœ</text>
          </view>
          <view class="record-item losses">
            <text>{{item.record_losses}}</text>
            <text>è´Ÿ</text>
          </view>
          <view class="record-item draws" wx:if="{{item.record_draws > 0}}">
            <text>{{item.record_draws}}</text>
            <text>å¹³</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{list.length > 0 && has_more && !loading}}">
    <button class="load-more-btn" bindtap="onLoadMore">åŠ è½½æ›´å¤š</button>
  </view>
  <view class="load-more" wx:if="{{loading && list.length > 0}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>
