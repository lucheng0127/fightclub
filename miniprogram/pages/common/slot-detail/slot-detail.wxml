<!-- æ—¶é—´æ®µè¯¦æƒ…é¡µ -->
<view class="container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="nav-bar" style="padding-top: {{statusBarHeight}}px; height: {{navBarHeight}}px;">
    <view class="nav-bar-content">
      <text class="nav-bar-back" bindtap="onBack">â†</text>
      <text class="nav-bar-title">åœºåœ°è¯¦æƒ…</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content" wx:if="{{!loading && slot}}" style="padding-top: {{navBarHeight + 20}}px;">
    <!-- æ‹³é¦†ä¿¡æ¯ -->
    <view class="section gym-section">
      <view class="section-title">æ‹³é¦†ä¿¡æ¯</view>
      <view class="gym-card">
        <view class="gym-name">{{gym.name}}</view>
        <view class="gym-info-row">
          <text class="info-icon">ğŸ“</text>
          <text class="info-text">{{gym.city}} {{gym.address}}</text>
        </view>
        <view class="gym-info-row">
          <text class="info-icon">ğŸ“</text>
          <text class="info-text">{{gym.phone}}</text>
        </view>
      </view>
    </view>

    <!-- æ—¶é—´æ®µä¿¡æ¯ -->
    <view class="section slot-section">
      <view class="section-title">æ—¶é—´æ®µ</view>
      <view class="slot-card">
        <view class="slot-row">
          <text class="slot-label">æ—¥æœŸ</text>
          <text class="slot-value">{{slot.date}}</text>
        </view>
        <view class="slot-row">
          <text class="slot-label">æ—¶é—´</text>
          <text class="slot-value">{{slot.start_time}} - {{slot.end_time}}</text>
        </view>
        <view class="slot-row">
          <text class="slot-label">äººæ•°</text>
          <text class="slot-value">{{slot.current_bookings}}/{{slot.max_boxers}}</text>
        </view>
        <view class="slot-row">
          <text class="slot-label">çŠ¶æ€</text>
          <view class="status-badge {{slot.available_spots === 0 ? 'full' : 'available'}}">
            <text>{{slot.available_spots === 0 ? 'å·²æ»¡' : slot.available_spots + 'ä¸ªåé¢'}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- é¢„çº¦æ‹³æ‰‹åˆ—è¡¨ -->
    <view class="section bookings-section" wx:if="{{slot.current_bookings > 0}}">
      <view class="section-title">
        <text>å·²é¢„çº¦æ‹³æ‰‹</text>
        <text class="count">({{slot.current_bookings}})</text>
      </view>
      <view class="bookings-list">
        <view class="boxer-card" wx:for="{{bookers}}" wx:key="boxer_id" bindtap="onBoxerTap" data-id="{{item.boxer_id}}">
          <view class="boxer-avatar">ğŸ¥Š</view>
          <view class="boxer-info">
            <view class="boxer-name">{{item.nickname}}</view>
            <view class="boxer-details">
              <text>{{item.age}}å²</text>
              <text>{{item.height}}cm</text>
              <text>{{item.weight}}kg</text>
              <text wx:if="{{item.city}}">{{item.city}}</text>
            </view>
          </view>
          <view class="boxer-gender {{item.gender === 'male' ? 'male' : 'female'}}">
            {{item.gender === 'male' ? 'â™‚' : 'â™€'}}
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="actions">
      <button
        class="action-btn book-btn"
        bindtap="onBook"
        disabled="{{slot.available_spots === 0 || slot.is_booked || booking}}"
        wx:if="{{!slot.is_booked}}"
      >
        {{booking ? 'é¢„çº¦ä¸­...' : (slot.available_spots === 0 ? 'åé¢å·²æ»¡' : 'ç«‹å³é¢„çº¦')}}
      </button>

      <button
        class="action-btn cancel-btn"
        bindtap="onCancel"
        disabled="{{cancelling}}"
        wx:if="{{slot.is_booked}}"
      >
        {{cancelling ? 'å–æ¶ˆä¸­...' : 'å–æ¶ˆé¢„çº¦'}}
      </button>

      <button class="action-btn view-btn" bindtap="onViewBookings" wx:if="{{slot.current_bookings > 0}}">
        æŸ¥çœ‹å…¨éƒ¨é¢„çº¦
      </button>
    </view>
  </view>
</view>
